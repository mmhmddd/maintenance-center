<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل مستخدم جديد</title>
    <link rel="stylesheet" href="register.css">
    <!-- تحميل مكتبة Firebase الموحدة -->
    <script type="module">
        // استيراد Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        // تهيئة Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAsV0ghr_t8qQnrT4nbSU20W1d-E4nl4Nk",
            authDomain: "maintenance-auth-712f0.firebaseapp.com",
            projectId: "maintenance-auth-712f0",
            storageBucket: "maintenance-auth-712f0.firebasestorage.app",
            messagingSenderId: "209495320732",
            appId: "1:209495320732:web:809d1b835e0d89bd15a559",
            measurementId: "G-PR0W9ZQQBD"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // دالة التسجيل
        window.register = function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value; // للمعلومات فقط، لن يُستخدم للمصادقة
            const name = document.getElementById('name').value;

            // إنشاء معرف عشوائي للمستخدم
            const userId = Math.random().toString(36).substr(2, 9);

            setDoc(doc(db, "users", userId), {
                name: name,
                email: email,
                createdAt: new Date(),
                password: password // ملاحظة: تخزين كلمة المرور هنا غير آمن، يجب تشفيرها
            })
            .then(() => {
                alert('تم تسجيل البيانات بنجاح!');
                window.location.href = '/auth/login/login.html';
            })
            .catch((error) => {
                alert('خطأ في حفظ البيانات: ' + error.message);
            });
        };
    </script>
</head>
<body>
    <div class="container">
        <h2>تسجيل مستخدم جديد</h2>
        <input type="text" id="name" placeholder="الاسم" required>
        <input type="email" id="email" placeholder="البريد الإلكتروني" required>
        <input type="password" id="password" placeholder="كلمة المرور" required>
        <button onclick="register()">تسجيل</button>
        <p>لديك حساب؟ <a href="login.html">تسجيل الدخول</a></p>
    </div>
</body>
</html>